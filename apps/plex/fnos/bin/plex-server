#!/bin/sh
APP_NAME=plexmediaserver
APP_DIR="${TRIM_APPDEST}"
APP_DATA_DIR=$1
PID_FILE="$APP_DATA_DIR"/$APP_NAME.pid

export PLEX_MEDIA_SERVER_APPLICATION_SUPPORT_DIR=$APP_DATA_DIR/Library/Application\ Support
export PLEX_MEDIA_SERVER_HOME=$APP_DIR
export PLEX_MEDIA_SERVER_MAX_PLUGIN_PROCS=6
export PLEX_MEDIA_SERVER_INFO_VENDOR=fnOS
export PLEX_MEDIA_SERVER_INFO_DEVICE="fnOS NAS"
export PLEX_MEDIA_SERVER_INFO_MODEL="$(uname -m)"
export PLEX_MEDIA_SERVER_INFO_PLATFORM_VERSION="$(uname -r)"
export TMPDIR=$APP_DATA_DIR/tmp
export LD_LIBRARY_PATH=$APP_DIR/lib:$LD_LIBRARY_PATH
export PATH=$APP_DIR:$PATH

mkdir -p "$PLEX_MEDIA_SERVER_APPLICATION_SUPPORT_DIR"
mkdir -p "$TMPDIR"

cd $APP_DIR || exit 1
exec ./Plex\ Media\ Server
